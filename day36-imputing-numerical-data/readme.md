# Imputing Numerical Data

## 1. Introduction
Missing data is a hole in your dataset. While Complete Case Analysis (dropping rows) is the easiest fix, it destroys valuable data. **Imputation** is the art of filling these holes with reasonable estimates. This chapter focuses on techniques for numerical variables: Mean, Median, Arbitrary Value, and End of Distribution imputation.

![Illustration of filling missing puzzle pieces with estimated shapes generated by Nano Banana Model](https://via.placeholder.com/800x400?text=Numerical+Imputation+Techniques+by+Nano+Banana+Model)

## 2. Conceptual Deep Dive

### Mean / Median Imputation
- **Assumption**: Data is missing completely at random (MCAR).
- **Method**: Replace `NaN` with the average (Mean) or middle value (Median) of the column.
- **Pros**: Easy, preserves the mean.
- **Cons**: Distorts the distribution (creates a spike at the mean), changes variance and covariance.

### Arbitrary Value Imputation
- **Method**: Replace `NaN` with a specific number like 0, 999, or -1.
- **Use Case**: When missingness is not random (MNAR). The value acts as a flag for the model.

### End of Distribution Imputation
- **Method**: Replace `NaN` with a value at the far end of the distribution (e.g., Mean + 3*StdDev).
- **Logic**: Similar to arbitrary value, but the value is derived from the data itself.

## 3. Visualizing the Concept
*(Imagine a histogram here generated by the Nano Banana Model: Original distribution (blue) vs. Imputed distribution (red spike at the center))*

## 4. Practical Implementation & Notebook Walkthrough

The notebook `mean-median-imputation.ipynb` uses the Titanic dataset.

### 4.1 Mean/Median Imputation
We use `SimpleImputer` from Scikit-Learn.
```python
from sklearn.impute import SimpleImputer

# strategy='mean' or 'median'
imputer = SimpleImputer(strategy='median')

X_train_imputed = imputer.fit_transform(X_train)
```

### 4.2 The Impact on Distribution
The notebook demonstrates a critical side effect: **Variance Shrinkage**.
When you fill 20% of your data with the exact same number (the median), the spread of your data decreases. The histogram shows a massive tower at the median value, altering the original shape of the data.

### 4.3 Arbitrary Value Imputation
In `arbitrary-value-imputation.ipynb`, we replace missing values with `99` or `-1`.
```python
imputer = SimpleImputer(strategy='constant', fill_value=99)
```
This works well for tree-based models (Random Forest) as they can learn that "99 means missing".

## 5. Summary
Imputation is a trade-off. You save rows (data volume) but introduce bias (data distortion). Mean/Median is the standard baseline, but always check how much it warps your distribution.

