# Imputing Categorical Data

## 1. Introduction
Numerical imputation is about math (averages), but categorical imputation is about probability. If a "Color" is missing, you can't calculate the "average color". You have to guess the most likely category or create a new one. This chapter covers **Frequent Category Imputation** (Mode) and **Missing Category Imputation**.

![Diagram showing missing labels being replaced by the most common label generated by Nano Banana Model](https://via.placeholder.com/800x400?text=Categorical+Imputation+by+Nano+Banana+Model)

## 2. Conceptual Deep Dive

### Frequent Category Imputation (Mode)
- **Logic**: If 90% of cars are "Red", it's a safe bet that a missing value is also "Red".
- **Assumption**: Data is Missing At Random (MAR).
- **Risk**: Over-represents the dominant class.

### Missing Category Imputation
- **Logic**: Treat "Missing" as a category of its own. Replace `NaN` with the word "Missing" or "Unknown".
- **Assumption**: The missingness itself is information (MNAR).
- **Benefit**: No assumptions made; the model learns the relationship between "Missing" and the target.

## 3. Visualizing the Concept
*(Imagine a bar chart here generated by the Nano Banana Model: The 'Missing' bar is converted into the tallest existing bar (Mode Imputation) vs. becoming a new bar of its own)*

## 4. Practical Implementation & Notebook Walkthrough

The notebook `frequent-value-imputation.ipynb` uses the House Prices dataset.

### 4.1 Mode Imputation
We identify the most frequent value (Mode) and fill `NaN`s with it.
```python
# Find the mode
mode_val = df['GarageQual'].mode()[0]

# Fill
df['GarageQual'].fillna(mode_val, inplace=True)
```
*Scikit-Learn Way*:
```python
imputer = SimpleImputer(strategy='most_frequent')
```

### 4.2 Visualizing the Distortion
The notebook plots the distribution before and after.
- **Before**: `TA` (Typical/Average) is the highest bar.
- **After**: The `TA` bar becomes even taller because all missing values were added to it.

### 4.3 Missing Category Imputation
In `missing-category-imputation.ipynb`, we simply fill with a new label.
```python
imputer = SimpleImputer(strategy='constant', fill_value='Missing')
```
This is often the safest and most robust method for categorical data.

## 5. Summary
For categorical data, if the missingness is low (<5%), use Mode Imputation. If it's high (>10%), create a new "Missing" category. This preserves the information that the data was originally missing.
