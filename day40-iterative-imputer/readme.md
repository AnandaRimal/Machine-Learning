# Iterative Imputer (MICE)

## 1. Introduction
If KNN Imputer is smart, **Iterative Imputer** is a genius. Also known as **MICE (Multivariate Imputation by Chained Equations)**, it treats missing data as a regression problem. It builds a machine learning model to predict the missing values of one column using all other columns as features, and it does this in a loop until the values stabilize.

![Diagram showing the cyclic process of MICE imputation generated by Nano Banana Model](https://via.placeholder.com/800x400?text=MICE+Imputation+Cycle+by+Nano+Banana+Model)

## 2. Conceptual Deep Dive

### The Algorithm (Simplified)
1.  **Initialization**: Fill all missing values with the Mean.
2.  **Iteration**:
    - Select one column (e.g., `Age`) as the **Target**.
    - Use all other columns (`Fare`, `Pclass`) as **Features**.
    - Train a Regressor (Linear, Bayesian, Decision Tree) on the rows where `Age` is known.
    - Predict `Age` for the rows where it is missing.
    - Repeat for every column.
3.  **Convergence**: Repeat the cycle multiple times until the imputed values stop changing significantly.

## 3. Visualizing the Concept
*(Imagine a loop here generated by the Nano Banana Model: Data gets refined in each pass, becoming more and more accurate)*

## 4. Practical Implementation & Notebook Walkthrough

The notebook `step-by-step.ipynb` manually implements the first iteration of MICE to demystify the magic.

### 4.1 Manual Walkthrough
1.  **Impute with Mean**: Create a baseline dataframe `df0`.
2.  **Target Selection**: We remove the imputed value of the first column (making it `NaN` again) to predict it.
3.  **Model Training**: We train a Linear Regression model using the other (mean-imputed) columns.
4.  **Prediction**: We fill the `NaN` with the model's prediction.
5.  **Repeat**: We move to the next column and use the *newly predicted* value of the first column to help predict the second.

### 4.2 Using Scikit-Learn
In practice, we use `IterativeImputer`.
```python
from sklearn.experimental import enable_iterative_imputer # Explicitly enable experimental feature
from sklearn.impute import IterativeImputer

# max_iter=10, random_state=0
imputer = IterativeImputer(max_iter=10, random_state=0)

X_train_trf = imputer.fit_transform(X_train)
```

## 5. Summary
Iterative Imputer is the state-of-the-art for tabular data imputation. It leverages the predictive power of your entire dataset to fill in the blanks. It is computationally intensive but often yields the most realistic results.

